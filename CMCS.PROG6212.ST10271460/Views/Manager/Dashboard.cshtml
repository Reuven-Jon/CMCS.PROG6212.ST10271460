@model IEnumerable<CMCS.PROG6212.ST10271460.Models.Claim>

<div class="container mt-5">
    <h2 class="text-center" style="color: #ff6600;">Coordinator/Manager Dashboard</h2>

    <!-- Welcome message pop-up -->
    <div id="welcome-popup" style="background-color: #f4f7f6; padding: 20px; border: 1px solid #ddd; margin-bottom: 20px;">
        <h4>Welcome to the Coordinator/Manager Dashboard!</h4>
        <p>Here you can manage and approve claims.</p>
    </div>

    <!-- Claims Table -->
    <div class="card mt-4">
        <h3>Manage Claims</h3>
        <table border="1" cellpadding="10" cellspacing="0" width="100%">
            <thead>
                <tr>
                    <th>Lecturer Name</th>
                    <th>Claim Period</th>
                    <th>Hours Worked</th>
                    <th>Status</th>
                    <th>Actions</th>
                    <th>Document</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var claim in Model)
                {
                    <tr>
                        <td>@claim.LecturerName</td>
                        <td>@claim.ClaimPeriod.ToString("MMMM yyyy")</td>
                        <td>@claim.HoursWorked</td>
                        <td><span class="status @claim.Status.ToLower()">@claim.Status</span></td>
                        <td>
                            <button class="btn btn-success" onclick="updateClaimStatus('@claim.Id', 'Approved')">Approve</button>
                            <button class="btn btn-danger" onclick="updateClaimStatus('@claim.Id', 'Rejected')">Reject</button>
                        </td>
                        <td>
                            @if (!string.IsNullOrEmpty(claim.DocumentPath))
                            {
                                <a href="@claim.DocumentPath" target="_blank">View Document</a>
                            }
                            else
                            {
                                <span>No document</span>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <script>
        function updateClaimStatus(claimId, status) {
            const managerNote = prompt("Enter a note for this claim:");
            if (managerNote) {
                $.post(`/Manager/UpdateClaimStatus`, { claimId, status, managerNote }, function () {
                    alert(`Claim ${status}`);
                    location.reload(); // Reload the page after status update
                });
            }
        }

        // Hide the welcome popup after 5 seconds
        setTimeout(function () {
            document.getElementById('welcome-popup').style.display = 'none';
        }, 5000);
    </script>
</div>









